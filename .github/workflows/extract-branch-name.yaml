name: Extract Branch names

on:
  push:
    branches:
      - main
      - qa
      - dev
      - 'release/*'
      - 'feature/*'

jobs:
  extract:
    runs-on: ubuntu-latest

    steps:
      - name: Extract names
        run: |
          echo 'github.ref: ' ${{ github.ref }}

      - name: Extract version from branch name
        id: extract_version
        run: |
          # –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–º—è –≤–µ—Ç–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π GITHUB_REF
          branch_name="${GITHUB_REF#refs/heads/}"
          
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏
          if [[ "$branch_name" =~ release/([0-9]+\.[0-9]+\.[0-9]+) ]]; then
          version="${BASH_REMATCH[1]}"
          echo "Extracted Version: $version"
          echo "RELEASE_VERSION=${version}" >> ${GITHUB_ENV}
          else
          echo "–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å –≤–µ—Ä—Å–∏—é –∏–∑ –∏–º–µ–Ω–∏ –≤–µ—Ç–∫–∏"
          exit 1
          fi

      - name: Use extracted version
        run: echo "Extracted version is ${{ env.RELEASE_VERSION }}"

  greet:
    runs-on: ubuntu-latest

    steps:
      - name: Send greeting
        run: echo "${{ github.event.inputs.message }} ${{ fromJSON('["", "ü•≥"]')[github.event.inputs.use-emoji == 'true'] }} ${{ github.event.inputs.name }}"